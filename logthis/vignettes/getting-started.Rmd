---
title: "Getting Started with logthis"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Getting Started with logthis}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

```{r setup}
library(logthis)
```

# Introduction

The `logthis` package provides a structured logging framework for R applications. This vignette will walk you through the basics of setting up and using loggers in your R projects.

## Creating Your First Logger

The simplest way to get started is to create a logger with console output:

```{r basic-logger}
# Create a basic logger
log_this <- logger() %>%
    with_receivers(to_console()) %>%
    with_limits(lower = NOTE, upper = HIGHEST)

# Test it out
log_this(NOTE("Hello, logging world!"))
log_this(WARNING("This is a warning"))
log_this(ERROR("This is an error"))
```

## Understanding Event Levels

`logthis` uses a hierarchical system with numeric levels from 0 to 100:

- **LOWEST (0)** - Lowest priority debugging
- **TRACE (10)** - Trace-level debugging
- **DEBUG (20)** - Verbose debugging output
- **NOTE (30)** - General notes and information
- **MESSAGE (40)** - Important messages
- **WARNING (60)** - Warning conditions
- **ERROR (80)** - Error conditions
- **CRITICAL (90)** - Critical events
- **HIGHEST (100)** - Highest priority

```{r event-levels}
# Create events at different levels
log_this(DEBUG("This is very detailed debug info"))
log_this(NOTE("Application started successfully"))
log_this(MESSAGE("Processing 1000 records"))
log_this(WARNING("Found 5 missing values"))
log_this(ERROR("Database connection failed"))
```

## Filtering with Limits

`logthis` provides a sophisticated two-level filtering system:

### Logger-Level Filtering (First Filter)

Set limits on the entire logger - events outside these bounds never reach any receivers:

```{r logger-filtering}
# Only WARNING and ERROR events are processed at all
log_this <- logger() %>%
    with_receivers(to_console()) %>%
    with_limits(lower = WARNING, upper = HIGHEST)

log_this(NOTE("This won't be processed"))      # Blocked by logger
log_this(WARNING("This will be processed"))    # Passes logger filter
```

### Receiver-Level Filtering (Second Filter)  

Each receiver can further filter events that passed the logger filter:

```{r receiver-filtering}
# Logger allows NOTE+, but console receiver only shows WARNING+
log_this <- logger() %>%
    with_receivers(to_console(lower = WARNING)) %>%
    with_limits(lower = NOTE, upper = HIGHEST)

log_this(DEBUG("Blocked by logger"))      # Below logger limit
log_this(NOTE("Blocked by receiver"))       # Passes logger, blocked by receiver
log_this(WARNING("Reaches console"))        # Passes both filters
```

### Combined Filtering Strategy

```{r combined-filtering}
# Sophisticated filtering with multiple receivers
log_this <- logger() %>%
    with_receivers(
        to_console(lower = WARNING),     # Console: warnings and errors only
        to_identity()                        # Audit: all events that pass logger  
    ) %>%
    with_limits(lower = NOTE, upper = HIGHEST)  # Logger: notes and above

# Events flow: DEBUG blocked by logger
#              NOTE reaches audit receiver only
#              WARNING+ reaches both receivers
```

## Multiple Receivers

A powerful feature of `logthis` is the ability to send log events to multiple destinations:

```{r multiple-receivers}
```{r multiple-receivers}
# Send to console and capture for testing
log_this <- logger() %>%
    with_receivers(
        to_console(),
        to_identity()  # Returns the event for inspection
    )

result <- log_this(WARNING("Sent to multiple receivers"))
print(result)  # The returned event object
```
```

## Custom Event Levels

You can define your own event levels for specific use cases:

```{r custom-levels}
# Define custom levels
TRACE <- log_event_level("TRACE", 10)
DEBUG <- log_event_level("DEBUG", 30)
INFO <- log_event_level("INFO", 50)

# Use custom levels
log_this(TRACE("Entering function xyz()"))
log_this(DEBUG("Variable x = 42"))  
log_this(INFO("Processing completed"))
```

## Structured Logging

Log events can contain additional metadata:

```{r structured}
# Create events with custom fields
user_event <- WARNING("User login failed", 
                     user_id = "john_doe",
                     ip_address = "192.168.1.100",
                     attempt_count = 3)

log_this(user_event)
```

## Next Steps

This covers the basics of using `logthis`. For more advanced usage including:

- Integration with Shiny applications
- Custom receivers
- File logging
- Production configurations

See the "Advanced Usage" vignette.